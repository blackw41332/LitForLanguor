<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <title>{{ page.title }} | {{ site.title | default: 'Lit for Languor' }}</title>
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
</head>
<body>
  <header class="site-header">
    <div class="container">
      <h1><a href="{{ '/' | relative_url }}">{{ site.title | default: 'Lit for Languor' }}</a></h1>
      <nav class="site-nav">
        <a href="{{ '/' | relative_url }}">Home</a>
        <a href="{{ '/stories/' | relative_url }}">Stories</a>
        <a href="{{ '/poems/' | relative_url }}">Poems</a>
        <a href="{{ '/short-stories/' | relative_url }}">Short Stories</a>
        <a href="{{ '/reading-of-the-day/' | relative_url }}">Daily Read</a>
      </nav>
      <button id="theme-toggle" aria-label="Toggle theme"></button>
    </div>
  </header>

  <main class="content">
    <div class="container">
      {{ content }}
    </div>
  </main>

  <footer class="site-footer">
    <div class="container">
      <small>&copy; {{ site.time | date: "%Y" }} {{ site.title | default: "Lit for Languor" }}</small>
    </div>
  </footer>
  <script>
  const btn = document.getElementById('theme-toggle');
  const root = document.documentElement;
  const icons = { light: '🌙', dark: '☀️' };

  // Initialize theme & icon
  let theme = localStorage.getItem('theme');
  if (!theme) {
    // default to system preference
    theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
  }
  root.setAttribute('data-theme', theme);
  btn.textContent = icons[theme];

  // Toggle on click
  btn.addEventListener('click', () => {
    theme = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
    root.setAttribute('data-theme', theme);
    localStorage.setItem('theme', theme);
    btn.textContent = icons[theme];
  });
</script>
 <script>
    document.addEventListener('DOMContentLoaded', async () => {
      // 1) Grab every .docx in your three folders
      const reads = [
        {% assign docs = site.static_files 
            | where_exp: "f", "f.extname == '.docx'" %}
        {% assign stories = docs | where_exp: "f", "f.path contains '/stories/'" %}
        {% assign poems   = docs | where_exp: "f", "f.path contains '/poems/'" %}
        {% assign ss      = docs | where_exp: "f", "f.path contains '/short-stories/'" %}
        {% assign all     = stories | concat: poems | concat: ss %}
        {% for f in all %}
          {
            url:  "{{ f.relative_path | relative_url }}",
            type: "{{ f.relative_path contains '/poems/' | default: false | 
                     where: true, 'poem', 'story' }}"
          }{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ];

      // 2) Pick & fetch
      const pick = reads[Math.floor(Math.random() * reads.length)];
      try {
        const res  = await fetch(pick.url);
        const text = await res.text();
        const doc  = new DOMParser()
                        .parseFromString(text, "text/html");

        // 3) Get paragraphs from the same default layout
        const rootEl = doc.querySelector(".content");
        const paras  = Array.from(rootEl.querySelectorAll("p"));

        // 4) Snippet: 1 <p> for poems, 3 for stories
        const count = pick.type === "poem" ? 1 : 3;
        const snippet = paras
          .slice(0, count)
          .map(p => `<p>${p.innerHTML}</p>`)
          .join("");

        // 5) Inject & link to the .docx
        document.getElementById("daily-content")
                .innerHTML = snippet;
        document.getElementById("daily-link")
                .setAttribute("href", pick.url);
      } catch (err) {
        console.error("Daily Read failed:", err);
        document.getElementById("daily-content")
                .textContent = "Sorry, today's reading failed to load.";
      }
    });
  </script>
</body>
</html>

