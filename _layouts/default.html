<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <title>{{ page.title }} | {{ site.title | default: 'Lit for Languor' }}</title>
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
</head>
<body>
  <header class="site-header">
    <div class="container">
      <h1><a href="{{ '/' | relative_url }}">{{ site.title | default: 'Lit for Languor' }}</a></h1>
      <nav class="site-nav">
        <a href="{{ '/' | relative_url }}">Home</a>
        <a href="{{ '/stories/' | relative_url }}">Stories</a>
        <a href="{{ '/poems/' | relative_url }}">Poems</a>
        <a href="{{ '/short-stories/' | relative_url }}">Short Stories</a>
        <a href="{{ '/reading-of-the-day/' | relative_url }}">Daily Read</a>
      </nav>
      <button id="theme-toggle" aria-label="Toggle theme"></button>
    </div>
  </header>

  <main class="content">
    <div class="container">
      {{ content }}
    </div>
  </main>

  <footer class="site-footer">
    <div class="container">
      <small>&copy; {{ site.time | date: "%Y" }} {{ site.title | default: "Lit for Languor" }}</small>
    </div>
  </footer>
  <script>
  const btn = document.getElementById('theme-toggle');
  const root = document.documentElement;
  const icons = { light: 'ðŸŒ™', dark: 'â˜€ï¸' };

  // Initialize theme & icon
  let theme = localStorage.getItem('theme');
  if (!theme) {
    // default to system preference
    theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
  }
  root.setAttribute('data-theme', theme);
  btn.textContent = icons[theme];

  // Toggle on click
  btn.addEventListener('click', () => {
    theme = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
    root.setAttribute('data-theme', theme);
    localStorage.setItem('theme', theme);
    btn.textContent = icons[theme];
  });
</script>
 <script>
  document.addEventListener('DOMContentLoaded', async () => {
    // Build the reads[] array via Jekyll/Liquid
    const reads = [
    {% assign story_pages = site.pages | where_exp: "p", "p.url contains '/stories/'" %}
    {% assign poem_pages  = site.pages | where_exp: "p", "p.url contains '/poems/'" %}
    {% assign ss_pages    = site.pages | where_exp: "p", "p.url contains '/short-stories/'" %}
    {% assign all_pages   = story_pages | concat: poem_pages | concat: ss_pages %}
    {% for work in all_pages %}
      {
        url:  "{{ work.url | relative_url }}",
        type: "{% if work.url contains '/poems/' %}poem{% else %}story{% endif %}"
      }{% unless forloop.last %},{% endunless %}
    {% endfor %}
    ];

    // Pick one at random
    const pick = reads[Math.floor(Math.random() * reads.length)];

    try {
      // Fetch and parse the live page
      const res  = await fetch(pick.url);
      const text = await res.text();
      const doc  = new DOMParser().parseFromString(text, "text/html");

      // Select your main-text container
      const contentRoot = doc.querySelector(".content") || doc.querySelector("main");
      const paras       = Array.from(contentRoot.querySelectorAll("p"));

      // Build snippet: 1 <p> for poems, 3 for stories
      const sliceCount  = pick.type === "poem" ? 1 : 3;
      const snippetHtml = paras
        .slice(0, sliceCount)
        .map(p => `<p>${p.innerHTML}</p>`)
        .join("");

      // Inject into this page
      document.getElementById("daily-content").innerHTML = snippetHtml;
      document.getElementById("daily-link").href         = pick.url;
    } catch (err) {
      console.error("Failed to load Daily Read:", err);
      document.getElementById("daily-content")
        .textContent = "Sorry, today's reading is unavailable.";
    }
  });
</script>
</body>
</html>

